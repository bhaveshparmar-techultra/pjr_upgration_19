<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="view_order_form" model="ir.ui.view">
        <field name="name">sale.order.form.line.sequence</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <!-- Add computed fields before order_line -->
            <field name="order_line" position="before">
                <field name="max_line_sequence" invisible="True"/>
                <field name="company_check" invisible="True"/>
            </field>

            <!-- Set default sequence context for new lines -->
            <field name="order_line" position="attributes">
                <attribute name="context">{'default_sequence': max_line_sequence}</attribute>
            </field>

            <!-- Add sequence2 field before product_id in the list view -->
            <xpath expr="//field[@name='order_line']/list/field[@name='product_id']" position="before">
                <field name="sequence2" string="NO." optional="show"/>
            </xpath>

            <!-- Add length and width fields before product_uom_qty -->
            <xpath expr="//field[@name='order_line']/list/field[@name='product_uom_qty']" position="before">
                <field name="length" optional="hide" column_invisible="parent.company_check"/>
                <field name="width" optional="hide" column_invisible="parent.company_check"/>
            </xpath>

            <!-- Set options on product_template_id to disable create/open -->
            <xpath expr="//field[@name='order_line']/list/field[@name='product_template_id']" position="attributes">
                <attribute name="options">{'no_open': True, 'no_create': True, 'no_create_edit': True, 'show_label_warning': True}</attribute>
            </xpath>
        </field>
    </record>
</odoo>
